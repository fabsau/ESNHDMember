extends layout

block content
    .container.mt-5
        if message
            div(class="alert alert-" + message.type)
                p= message.text
                button.close-alert(type='button') Ok
        h1 Hello, #{firstName} #{lastName}!
        .row.justify-content-center

            .toggle-button
                button.btn.btn-primary(type='button', id='monthly') 6-Months
                button.btn.btn-primary(type='button', id='annually') Annually

            - var plans = ['Member', 'Alumni']
            each plan, index in plans
                .col-md-6.my-4
                    .price-card
                        h2 #{plan}
                        if index === 0
                            p.price(id='member-price') 10€
                        else
                            p.price(id='alumni-price') 20€
                        p.period(id=(index === 0 ? 'member-period' : 'alumni-period')) /yearly
                        if index === 0
                            p.description Best for new and existing members
                        else
                            p.description For old members that wish to keep contributing
                        ul.perks
                            - var perks = index === 0 ? ['Full Membership'] : ['Full Membership', 'Alumni Benefit 1', 'Alumni Benefit 2']
                            each perk in perks
                                li= perk
                        if !subscription
                            form(action='/purchase', method='post', id='purchase-form')
                                input(type='hidden', name='priceId', id='priceId', value=(index === 1 ? process.env.SUBSCRIPTION_PRICE_ID_ALUMNI : process.env.SUBSCRIPTION_PRICE_ID_MEMBER))
                                input(type='hidden', name='_csrf', value=csrfToken)
                                input(type='hidden', name='paymentMethod', id='paymentMethod')
                                if index === 0
                                    .trial-checkbox
                                        input.form-check-input(type='checkbox', name='trialEnabled', id='trialEnabled1')
                                        label.form-check-label(for='trialEnabled1') Activate New Membership Discount (first 6 Months free)
                                .payment-icons
                                    button.btn.btn-primary.active(type='button', name='paymentMethod', class='sepa', value='SEPA') SEPA
                                    button.btn.btn-primary(type='button', name='paymentMethod', class='visa', value='Visa') Visa
                                button.btn Buy Now
                        if subscription && subscription.plan.nickname == plan
                            button.btn.active-plan Active Plan
                            a(class='btn change-details', href=customerUrl) Manage Membership
                            form(action='/cancel-subscription', method='POST')
                                input(type='hidden', name='_csrf', value=csrfToken)
                                button.btn.btn-danger(type="submit") Cancel Membership
                        else if subscription
                            form(method='POST', action='/change-subscription', id='change-subscription-form')
                                input(type='hidden', name='newPlanId', id='newPlanId', value=(index === 1 ? process.env.SUBSCRIPTION_PRICE_ID_ALUMNI : process.env.SUBSCRIPTION_PRICE_ID_MEMBER))
                                input(type='hidden', name='_csrf', value=csrfToken)
                                button(type='submit') Switch Plan

    block scripts
        script(src="/javascripts/alerts.js")
        script(src="/javascripts/planperiod.js")
