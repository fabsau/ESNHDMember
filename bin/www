/**
 * Module dependencies.
 */
const app = require("../app");
const http = require("./http");
const https = require("./https");
const serverUtils = require('./serverUtils');

let port = serverUtils.normalizePort(process.env.PORT || "3000");
app.set("port", port);

let server;

if (process.env.ENABLE_HTTPS === "TRUE") {
  server = https.createHttpsServer(app);
} else {
  server = http.createServer(app);
}

if(server) {
  server.listen(port);
  server.on('error', serverUtils.onError);
  server.on('listening', () => serverUtils.onListening(server));
}
else {
  console.error("Server cannot be initialized. Check your configurations.")
}
